import{s as Oe,n as _e,r as ye,c as Pe,o as Re,i as Ue,d as Be}from"../chunks/scheduler.BTnDpNEN.js";import{S as Le,i as He,e as _,s as I,c as p,l as K,f as O,a as N,d,m as g,g as M,h as a,n as $,o as W,q as Ie,t as x,b as ee,j as ce,r as Ve,u as Ee}from"../chunks/index.ZX0_GDMe.js";import{e as he}from"../chunks/each.D6YF6ztN.js";import{a as ue}from"../chunks/axios.9PTFF6AP.js";import{p as je}from"../chunks/stores.CrXNav8h.js";function ke(e,t,s){const i=e.slice();return i[3]=t[s],i[24]=t,i[25]=s,i}function Ce(e,t,s){const i=e.slice();return i[26]=t[s],i}function Fe(e){let t;return{c(){t=_("span")},l(s){t=p(s,"SPAN",{}),N(t).forEach(d)},m(s,i){M(s,t,i)},p:_e,d(s){s&&d(t)}}}function Me(e){let t,s,i="select Email to assign",u,o,l,m,P,V,E=he(e[2]),v=[];for(let c=0;c<E.length;c+=1)v[c]=Te(Ce(e,E,c));function U(){e[12].call(t,e[3])}function j(){return e[13](e[3])}return{c(){t=_("select"),s=_("option"),s.textContent=i;for(let c=0;c<v.length;c+=1)v[c].c();u=I(),o=_("button"),l=x("Assign"),this.h()},l(c){t=p(c,"SELECT",{});var C=N(t);s=p(C,"OPTION",{"data-svelte-h":!0}),K(s)!=="svelte-zpfev4"&&(s.textContent=i);for(let A=0;A<v.length;A+=1)v[A].l(C);C.forEach(d),u=O(c),o=p(c,"BUTTON",{type:!0,class:!0});var b=N(o);l=ee(b,"Assign"),b.forEach(d),this.h()},h(){s.__value="",$(s,s.__value),e[0][e[3].id]===void 0&&Be(U),g(o,"type","button"),g(o,"class","btn btn-primary"),o.disabled=m=!e[0][e[3].id]},m(c,C){M(c,t,C),a(t,s);for(let b=0;b<v.length;b+=1)v[b]&&v[b].m(t,null);Ee(t,e[0][e[3].id],!0),M(c,u,C),M(c,o,C),a(o,l),P||(V=[W(t,"change",U),W(o,"click",j)],P=!0)},p(c,C){if(e=c,C&4){E=he(e[2]);let b;for(b=0;b<E.length;b+=1){const A=Ce(e,E,b);v[b]?v[b].p(A,C):(v[b]=Te(A),v[b].c(),v[b].m(t,null))}for(;b<v.length;b+=1)v[b].d(1);v.length=E.length}C&7&&Ee(t,e[0][e[3].id]),C&7&&m!==(m=!e[0][e[3].id])&&(o.disabled=m)},d(c){c&&(d(t),d(u),d(o)),Ie(v,c),P=!1,ye(V)}}}function Te(e){let t,s=e[26].email+"",i,u;return{c(){t=_("option"),i=x(s),this.h()},l(o){t=p(o,"OPTION",{});var l=N(t);i=ee(l,s),l.forEach(d),this.h()},h(){t.__value=u=e[26].email,$(t,t.__value)},m(o,l){M(o,t,l),a(t,i)},p(o,l){l&4&&s!==(s=o[26].email+"")&&ce(i,s),l&4&&u!==(u=o[26].email)&&(t.__value=u,$(t,t.__value))},d(o){o&&d(t)}}}function Ae(e){let t,s="To Repair",i,u;function o(){return e[15](e[3])}return{c(){t=_("button"),t.textContent=s},l(l){t=p(l,"BUTTON",{"data-svelte-h":!0}),K(t)!=="svelte-9ks2rc"&&(t.textContent=s)},m(l,m){M(l,t,m),i||(u=W(t,"click",o),i=!0)},p(l,m){e=l},d(l){l&&d(t),i=!1,u()}}}function Se(e){let t,s="Repaired",i,u;function o(){return e[16](e[3])}return{c(){t=_("button"),t.textContent=s,this.h()},l(l){t=p(l,"BUTTON",{class:!0,"data-svelte-h":!0}),K(t)!=="svelte-1yu6srj"&&(t.textContent=s),this.h()},h(){g(t,"class","btn btn-success")},m(l,m){M(l,t,m),i||(u=W(t,"click",o),i=!0)},p(l,m){e=l},d(l){l&&d(t),i=!1,u()}}}function De(e){let t,s="Dispose",i,u;function o(){return e[17](e[3])}return{c(){t=_("button"),t.textContent=s},l(l){t=p(l,"BUTTON",{"data-svelte-h":!0}),K(t)!=="svelte-x4471b"&&(t.textContent=s)},m(l,m){M(l,t,m),i||(u=W(t,"click",o),i=!0)},p(l,m){e=l},d(l){l&&d(t),i=!1,u()}}}function Ne(e){let t,s,i=e[3].assetName+"",u,o,l,m=e[3].assetState+"",P,V,E,v=e[3].purchaseDate+"",U,j,c,C=e[3].guaranteeEnd+"",b,A,z,F=(e[2].find(oe)?e[2].find(de).email:"Not Assinged")+"",q,te,Y,w,Q,S,r,R,B,ae,H,G,J,ne,se,X;function oe(...L){return e[10](e[3],...L)}function de(...L){return e[11](e[3],...L)}function Z(L,h){return L[3].assetState==="Unassigned"?Me:Fe}let D=Z(e),n=D(e);function T(){return e[14](e[3])}let f=e[3].assetState==="Assigned"&&Ae(e),k=e[3].assetState==="InRepair"&&Se(e),y=e[3].assetState!=="Disposed"&&De(e);return{c(){t=_("tr"),s=_("td"),u=x(i),o=I(),l=_("td"),P=x(m),V=I(),E=_("td"),U=x(v),j=I(),c=_("td"),b=x(C),A=I(),z=_("td"),q=x(F),te=I(),Y=_("td"),n.c(),w=I(),Q=_("td"),S=_("button"),r=x("Unassign"),ae=I(),H=_("td"),f&&f.c(),G=I(),k&&k.c(),J=I(),y&&y.c(),ne=I(),this.h()},l(L){t=p(L,"TR",{});var h=N(t);s=p(h,"TD",{});var le=N(s);u=ee(le,i),le.forEach(d),o=O(h),l=p(h,"TD",{});var fe=N(l);P=ee(fe,m),fe.forEach(d),V=O(h),E=p(h,"TD",{});var re=N(E);U=ee(re,v),re.forEach(d),j=O(h),c=p(h,"TD",{});var pe=N(c);b=ee(pe,C),pe.forEach(d),A=O(h),z=p(h,"TD",{});var me=N(z);q=ee(me,F),me.forEach(d),te=O(h),Y=p(h,"TD",{});var ve=N(Y);n.l(ve),ve.forEach(d),w=O(h),Q=p(h,"TD",{});var be=N(Q);S=p(be,"BUTTON",{type:!0,class:!0});var ge=N(S);r=ee(ge,"Unassign"),ge.forEach(d),be.forEach(d),ae=O(h),H=p(h,"TD",{});var ie=N(H);f&&f.l(ie),G=O(ie),k&&k.l(ie),J=O(ie),y&&y.l(ie),ie.forEach(d),ne=O(h),h.forEach(d),this.h()},h(){g(S,"type","button"),g(S,"class",R="btn "+(e[3].assetState==="Assigned"||e[3].assetState==="InRepair"?"btn-primary":"btn-secondary")),S.disabled=B=e[3].assetState!=="Assigned"&&e[3].assetState!=="InRepair"},m(L,h){M(L,t,h),a(t,s),a(s,u),a(t,o),a(t,l),a(l,P),a(t,V),a(t,E),a(E,U),a(t,j),a(t,c),a(c,b),a(t,A),a(t,z),a(z,q),a(t,te),a(t,Y),n.m(Y,null),a(t,w),a(t,Q),a(Q,S),a(S,r),a(t,ae),a(t,H),f&&f.m(H,null),a(H,G),k&&k.m(H,null),a(H,J),y&&y.m(H,null),a(t,ne),se||(X=W(S,"click",function(){Ue(e[3].assetState==="Assigned"||e[3].assetState==="InRepair"?T:null)&&(e[3].assetState==="Assigned"||e[3].assetState==="InRepair"?T:null).apply(this,arguments)}),se=!0)},p(L,h){e=L,h&2&&i!==(i=e[3].assetName+"")&&ce(u,i),h&2&&m!==(m=e[3].assetState+"")&&ce(P,m),h&2&&v!==(v=e[3].purchaseDate+"")&&ce(U,v),h&2&&C!==(C=e[3].guaranteeEnd+"")&&ce(b,C),h&6&&F!==(F=(e[2].find(oe)?e[2].find(de).email:"Not Assinged")+"")&&ce(q,F),D===(D=Z(e))&&n?n.p(e,h):(n.d(1),n=D(e),n&&(n.c(),n.m(Y,null))),h&6&&R!==(R="btn "+(e[3].assetState==="Assigned"||e[3].assetState==="InRepair"?"btn-primary":"btn-secondary"))&&g(S,"class",R),h&6&&B!==(B=e[3].assetState!=="Assigned"&&e[3].assetState!=="InRepair")&&(S.disabled=B),e[3].assetState==="Assigned"?f?f.p(e,h):(f=Ae(e),f.c(),f.m(H,G)):f&&(f.d(1),f=null),e[3].assetState==="InRepair"?k?k.p(e,h):(k=Se(e),k.c(),k.m(H,J)):k&&(k.d(1),k=null),e[3].assetState!=="Disposed"?y?y.p(e,h):(y=De(e),y.c(),y.m(H,null)):y&&(y.d(1),y=null)},d(L){L&&d(t),n.d(),f&&f.d(),k&&k.d(),y&&y.d(),se=!1,X()}}}function qe(e){let t,s="Create Asset",i,u,o,l,m,P="Asset name",V,E,v,U,j,c,C="Purchase Date",b,A,z,F,q,te="Guarantee End",Y,w,Q,S,r="Submit",R,B,ae="All Assets",H,G,J,ne='<tr><th scope="col">Name</th> <th scope="col">State</th> <th scope="col">Purchase Date</th> <th scope="col">Guarantee End</th> <th scope="col">Person</th> <th scope="col">Actions</th></tr>',se,X,oe,de,Z=he(e[1]),D=[];for(let n=0;n<Z.length;n+=1)D[n]=Ne(ke(e,Z,n));return{c(){t=_("h1"),t.textContent=s,i=I(),u=_("form"),o=_("div"),l=_("div"),m=_("label"),m.textContent=P,V=I(),E=_("input"),v=I(),U=_("div"),j=_("div"),c=_("label"),c.textContent=C,b=I(),A=_("input"),z=I(),F=_("div"),q=_("label"),q.textContent=te,Y=I(),w=_("input"),Q=I(),S=_("button"),S.textContent=r,R=I(),B=_("h1"),B.textContent=ae,H=I(),G=_("table"),J=_("thead"),J.innerHTML=ne,se=I(),X=_("tbody");for(let n=0;n<D.length;n+=1)D[n].c();this.h()},l(n){t=p(n,"H1",{class:!0,"data-svelte-h":!0}),K(t)!=="svelte-2752g2"&&(t.textContent=s),i=O(n),u=p(n,"FORM",{class:!0});var T=N(u);o=p(T,"DIV",{class:!0});var f=N(o);l=p(f,"DIV",{class:!0});var k=N(l);m=p(k,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),K(m)!=="svelte-irrc7u"&&(m.textContent=P),V=O(k),E=p(k,"INPUT",{class:!0,id:!0,type:!0}),k.forEach(d),f.forEach(d),v=O(T),U=p(T,"DIV",{class:!0});var y=N(U);j=p(y,"DIV",{class:!0});var L=N(j);c=p(L,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),K(c)!=="svelte-1hiaxaq"&&(c.textContent=C),b=O(L),A=p(L,"INPUT",{class:!0,id:!0,type:!0}),L.forEach(d),z=O(y),F=p(y,"DIV",{class:!0});var h=N(F);q=p(h,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),K(q)!=="svelte-enlo2c"&&(q.textContent=te),Y=O(h),w=p(h,"INPUT",{class:!0,id:!0,type:!0}),h.forEach(d),y.forEach(d),Q=O(T),S=p(T,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),K(S)!=="svelte-1rdh4yl"&&(S.textContent=r),T.forEach(d),R=O(n),B=p(n,"H1",{"data-svelte-h":!0}),K(B)!=="svelte-10ruias"&&(B.textContent=ae),H=O(n),G=p(n,"TABLE",{class:!0});var le=N(G);J=p(le,"THEAD",{"data-svelte-h":!0}),K(J)!=="svelte-1hvmccl"&&(J.innerHTML=ne),se=O(le),X=p(le,"TBODY",{});var fe=N(X);for(let re=0;re<D.length;re+=1)D[re].l(fe);fe.forEach(d),le.forEach(d),this.h()},h(){g(t,"class","mt-3"),g(m,"class","form-label"),g(m,"for","assetName"),g(E,"class","form-control"),g(E,"id","assetName"),g(E,"type","text"),g(l,"class","col"),g(o,"class","row mb-3"),g(c,"class","form-label"),g(c,"for","earnings"),g(A,"class","form-control"),g(A,"id","purchaseDate"),g(A,"type","date"),g(j,"class","col"),g(q,"class","form-label"),g(q,"for","earnings"),g(w,"class","form-control"),g(w,"id","guraranteeEnd"),g(w,"type","date"),g(F,"class","col"),g(U,"class","row mb-3"),g(S,"type","button"),g(S,"class","btn btn-primary"),g(u,"class","mb-5"),g(G,"class","table")},m(n,T){M(n,t,T),M(n,i,T),M(n,u,T),a(u,o),a(o,l),a(l,m),a(l,V),a(l,E),$(E,e[3].assetName),a(u,v),a(u,U),a(U,j),a(j,c),a(j,b),a(j,A),$(A,e[3].purchaseDate),a(U,z),a(U,F),a(F,q),a(F,Y),a(F,w),$(w,e[3].guaranteeEnd),a(u,Q),a(u,S),M(n,R,T),M(n,B,T),M(n,H,T),M(n,G,T),a(G,J),a(G,se),a(G,X);for(let f=0;f<D.length;f+=1)D[f]&&D[f].m(X,null);oe||(de=[W(E,"input",e[7]),W(A,"input",e[8]),W(w,"input",e[9]),W(S,"click",e[5])],oe=!0)},p(n,[T]){if(T&8&&E.value!==n[3].assetName&&$(E,n[3].assetName),T&8&&$(A,n[3].purchaseDate),T&8&&$(w,n[3].guaranteeEnd),T&87){Z=he(n[1]);let f;for(f=0;f<Z.length;f+=1){const k=ke(n,Z,f);D[f]?D[f].p(k,T):(D[f]=Ne(k),D[f].c(),D[f].m(X,null))}for(;f<D.length;f+=1)D[f].d(1);D.length=Z.length}},i:_e,o:_e,d(n){n&&(d(t),d(i),d(u),d(R),d(B),d(H),d(G)),Ie(D,n),oe=!1,ye(de)}}}function we(e,t,s){let i;Pe(e,je,r=>s(18,i=r));const u=i.url.origin;let o={},l=[],m=[],P={assetName:null,purchaseDate:null,guaranteeEnd:null,assetState:null,personId:null};Re(()=>{v(),U()});async function V(r,R){try{const B=await ue.put(`${u}/api/asset/${r}/${R}`);alert("Asset state updated to "+R),E()}catch(B){console.error("Failed to update asset state",B),alert("Failed to update asset state")}}async function E(){try{const r=await ue.get(`${u}/api/asset`);s(1,l=r.data)}catch(r){console.error("Error fetching assets",r)}}E();function v(){ue.get(`${u}/api/asset`).then(r=>{s(1,l=r.data),l.forEach(R=>{s(0,o[R.id]="",o)})}).catch(r=>console.error("Error fetching assets",r))}function U(){ue.get(u+"/api/person").then(r=>s(2,m=r.data)).catch(r=>{alert("Could not get persons"),console.log(r)})}function j(){ue.post(u+"/api/asset",P,{headers:{"Content-Type":"application/json"}}).then(r=>{alert("Asset created"),v()}).catch(r=>{alert("Could not create asset"),console.log(r)})}function c(r){if(!o[r]){alert("Please select an email to assign");return}const R={assetId:r,personEmail:o[r]};ue.put(`${u}/api/service/assignasset`,R,{headers:{"Content-Type":"application/json"}}).then(B=>{alert("Asset assigned"),v()}).catch(B=>{alert("Failed to assign asset"),console.error(B)})}function C(){P.assetName=this.value,s(3,P)}function b(){P.purchaseDate=this.value,s(3,P)}function A(){P.guaranteeEnd=this.value,s(3,P)}const z=(r,R)=>R.id===r.personId,F=(r,R)=>R.id===r.personId;function q(r){o[r.id]=Ve(this),s(0,o),s(2,m)}return[o,l,m,P,V,j,c,C,b,A,z,F,q,r=>c(r.id),r=>V(r.id,"unassign"),r=>V(r.id,"repair"),r=>V(r.id,"assign"),r=>V(r.id,"dispose")]}class Qe extends Le{constructor(t){super(),He(this,t,we,qe,Oe,{})}}export{Qe as component};
